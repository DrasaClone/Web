name: Build Android APK

# Chạy workflow này mỗi khi có push lên nhánh main
on:
  push:
    branches: [ "main" ] # Hoặc "master" tùy theo tên nhánh chính của bạn
  # Cho phép chạy workflow này thủ công từ tab Actions
  workflow_dispatch:

jobs:
  build:
    # Chạy trên máy ảo Ubuntu mới nhất của GitHub
    runs-on: ubuntu-latest

    steps:
      # Bước 1: Checkout mã nguồn của bạn từ repo về máy ảo
      - name: Checkout code
        uses: actions/checkout@v4

      # Bước 2: Cài đặt Java Development Kit (JDK) phiên bản 17
      # Android build hiện đại cần Java 17
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      # Bước 3: Setup Gradle
      # Bước này sẽ tự động cache các dependencies để lần build sau nhanh hơn
      - name: Setup Gradle
        uses: gradle/actions/setup-gradle@v3
        
      # Bước 4: Chạy lệnh build của Gradle để tạo file APK
      # Nó sẽ tự động tải Gradle wrapper nếu cần.
      # ./gradlew assembleDebug sẽ tạo ra một APK để debug.
      - name: Build with Gradle
        run: ./gradlew :app:assembleDebug

      # Bước 5: Tải file APK đã build xong lên làm artifact của workflow
      # Bạn có thể tải file này về sau khi build xong.
      - name: Upload APK
        uses: actions/upload-artifact@v4
        with:
          name: app-debug-apk # Tên của artifact
          path: app/build/outputs/apk/debug/app-debug.apk # Đường dẫn đến file APK
